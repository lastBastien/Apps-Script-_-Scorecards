//sheet specific function to highlight call listening based on row selected as "working"
function onEdit(e) {
  let user = Session.getActiveUser();
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  let headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues();
    let status = headers[0].indexOf('Status?')+1;
if (user){
    if (e.range.rowStart != 1 && e.range.columnStart == status && e.range.getDisplayValue() == "working"){
  
      let range = e.range;
      //const sheet = range.getActiveSheet();
      const maxRows = sheet.getMaxRows();
      const maxColumns = sheet.getMaxColumns();
      const lastCol = sheet.getLastColumn();
      sheet.getRange(1, 1, maxRows, maxColumns).setBackground(null);
      
  sheet.getRange(range.getRow(), 1, 1, lastCol).setBackground("lavender");
    } else if (e.range.rowStart != 1 && e.range.columnStart == status && e.range.getDisplayValue() == ""){
  
      let range = e.range;
      //const sheet = range.getActiveSheet();
      const maxRows = sheet.getMaxRows();
      const maxColumns = sheet.getMaxColumns();
      const lastCol = sheet.getLastColumn();
      sheet.getRange(1, 1, maxRows, maxColumns).setBackground(null);
      
  sheet.getRange(range.getRow(), 1, 1, lastCol).setBackground(null);
      /*e.range.setValue('Email Sent');
      e.range.offset(0,1).setValue('SUCCESS');
      emailSend();*/
    }
}
}
